<!DOCTYPE html>

<html>
<head>
  <title>ModalHandler.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>ModalHandler.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>ModalHandler.js</p>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="modalhandler">ModalHandler</h2>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Class handles functionality related to modals in the reporting section</p>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Empty constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @class ModalHandler
 * @constructor
 */</span>
<span class="hljs-keyword">var</span> ModalHandler = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};

<span class="hljs-comment">/**
 * Static unselected color value
 * 
 * @property unselectedColor
 * @type string
 * @default "transparent"
 */</span>
ModalHandler.prototype.unselectedColor = <span class="hljs-string">"transparent"</span>;

<span class="hljs-comment">/**
 * Static selected color value
 * 
 * @property selectedColor
 * @type string
 * @default "rgb(149, 206, 226)"
 */</span>
ModalHandler.prototype.selectedColor = <span class="hljs-string">"rgb(149, 206, 226)"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Returns all “selectable” items in the current modal</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @method getSelectable
 * @description Returns all "selectable" items in the current modal
 * @param {HTML Document} htmlDoc The "document" variable from the current scope
 * @return {array} An array of all the elements in the current ui that are members
 *          of the "selectable" class.  This should be used for situations when the
 *          user selects from multiple pre-defined options listed as a grid of icons.
 * @throws none
 */</span>
ModalHandler.prototype.getSelectable = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">htmlDoc</span>) </span>{
	<span class="hljs-keyword">return</span> htmlDoc.getElementsByClassName(<span class="hljs-string">"selectable"</span>);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Resets (changes to the unselected color) all the backgrounds of elements that are members of the
“selectable class”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @method resetSelectableBackgrounds
 * @description
 * @param {HTML Document} htmlDoc The "document" variable from the current scope
 * @return void
 * @throws none
 */</span>
ModalHandler.prototype.resetSelectableBackgrounds = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">htmlDoc</span>) </span>{
	<span class="hljs-keyword">var</span> divArray = <span class="hljs-keyword">this</span>.getSelectable(htmlDoc);
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; divArray.length; i++)
	{
		divArray[i].style.backgroundColor = <span class="hljs-keyword">this</span>.unselectedColor;
	}
};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Sets a new temporary (unsaved) selection on a modal.  Handles background recoloring.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @method setNewTempSelection
 * @description
 * @param {HTML Document} htmlDoc The "document" variable from the current scope
 * @param {ionicModal} modal The app modal that the selection was performed on
 * @param {string} id The id of the element that was selected.
 */</span>
ModalHandler.prototype.setNewTempSelection = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">htmlDoc, modal, id</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Grab the selected element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> selectedElement = htmlDoc.getElementById(id);</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Check previous selections (temporary or saved)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span>((modal.temp &amp;&amp; modal.temp === id) || (modal.selection &amp;&amp; modal.selection === id))
	{</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>If selectedElement is the same as the previously selected element, deselect it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		modal.temp = <span class="hljs-string">""</span>;
		selectedElement.style.backgroundColor = <span class="hljs-keyword">this</span>.unselectedColor;
	}
	<span class="hljs-keyword">else</span>
	{</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>If any other element was previously (temporarily) selected, reset its background color</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span>(modal.temp &amp;&amp; modal.temp !== <span class="hljs-string">""</span>)
        {
            htmlDoc.getElementById(modal.temp).style.backgroundColor = <span class="hljs-keyword">this</span>.unselectedColor;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Save new temp selection</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        modal.temp = id;</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Update ui to new selected item</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		selectedElement.style.backgroundColor = <span class="hljs-keyword">this</span>.selectedColor;
	}
};</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Sets up any previsouly selected items from a modal (sets the background of the element indicated by “id” to
the selected color).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @method setPreviousSelection
 * @description
 * @param {HTML Document} htmlDoc The "document" variable from the current scope
 * @param {string} id The id of any previously selected element
 * @return void
 * @throws none
 */</span>
ModalHandler.prototype.setPreviousSelection = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">htmlDoc, id</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>If the id is valid…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span>(id !== <span class="hljs-string">""</span>)
    {</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Set background color to “selected”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        htmlDoc.getElementById(id).style.backgroundColor = <span class="hljs-keyword">this</span>.selectedColor;
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Opens a modal and handles setting up any selectable items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @method openModal
 * @description
 * @param {HTML Document} htmlDoc the "document" variable from the current scope
 * @param {ionicModal} The app modal to be opened.
 * @return void
 * @throws none
 */</span>
ModalHandler.prototype.openModal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">htmlDoc, modal</span>)
</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>If anything was previously selected…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span>(modal.selection)
    {</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Set it as selected currently</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.setPreviousSelection(htmlDoc, modal.selection);
    }
    <span class="hljs-keyword">else</span>
    {</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Otherwise, clear all backgrounds to the unselected color (takes care of any un-recycled view elements)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.resetSelectableBackgrounds(htmlDoc);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Actually display the modal</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    modal.show();
};</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Performs “Save” functionality for the specified modal.  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @method saveModal
 * @param {HTML Document} htmlDoc The "document" variable from the current scope.
 * @param {ionicModal} modal The modal to save.
 * @param {string} summaryElementId The id of the element to display the summary information in
 * @param {function} convertFunction The function that specifies how to convert the selected element id (in modal.temp)
 *          to the actual report value.
 * @param {function} formatSummaryText The function that handles formatting the summary field
 * @param {boolean} summaryDifferent OPTIONAL parameter that indicates whether the summary field should be different from
 *          what was saved into the report.
 */</span>
ModalHandler.prototype.saveModal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">htmlDoc, modal, summaryElementId, convertFunction, formatSummaryText, summaryDifferent</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Save the selection to the modal permanent variable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    modal.selection = modal.temp;</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Update the reportField with the passed formatting funcion</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> reportField = convertFunction(modal.selection);</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Grab a reference to the summary element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> summary = htmlDoc.getElementById(summaryElementId);</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>If the summary is flagged as different than the reportField value…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span>(summaryDifferent)
    {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Set it with its own provided formatting function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        summary.innerText = formatSummaryText(reportField);
    }
    <span class="hljs-keyword">else</span>
    {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Otherwise, set the summary text to the same as the report field</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span>(reportField &amp;&amp; reportField !== <span class="hljs-string">""</span>)
        {
            summary.innerText = reportField;
        }
        <span class="hljs-keyword">else</span>
        {</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>If no value was selected, re-display the blank “<strong>_</strong>“ that indicates no value selected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            summary.innerText = <span class="hljs-string">"______"</span>;
        }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Hide the modal</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    modal.hide();
    
};</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
